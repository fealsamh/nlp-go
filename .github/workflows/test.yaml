name: Test

on:
  workflow_dispatch:
    inputs:
      test-arg:
        description: 'Test argument'
        required: true
        default: '0.0.0'
      test-switch:
        type: boolean
        default: true
        description: 'Test switch'
      selection:
        type: choice
        description: 'Environment'
        default: testing
        options:
        - staging
        - testing
        - production

env:
  TEST_ARG: ${{ inputs.test-arg == "aa" && 'AA' || inputs.test-arg == 'bb' && 'BB' || format('={0}', inputs.test-arg) }}

jobs:
  test:
    strategy:
      matrix:
        go-version: [1.18.x]
        os: [ubuntu-latest]
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/setup-go@v3
        with:
          go-version: ${{ matrix.go-version }}
      - uses: actions/checkout@v3
      - run: |
          go run ./cmd/nlp
      - if: inputs.test-switch == true
        run: |
          echo Env sel is ${{ inputs.selection }}
